<ng-container *ngIf="layoutVersion === LayoutVersion.AngularMaterial">
  <mat-toolbar color="primary">
    <a class="navbar-brand" routerLinkActive="active" routerLink="/">Home Expenses</a>
    <div *ngIf="tokenAuthService.isValidAccessToken()" class="d-flex flex-grow-1 justify-content-end">
      <button type="button" class="btn btn-danger" (click)="signout()">Sign out</button>
    </div>
  </mat-toolbar>

  <mat-sidenav-container
    *ngLet="tokenAuthService.isValidAccessToken(); let isValidAccessToken"
    class="sidenav-container"
  >
    <mat-sidenav
      [ngClass]="isSidenavCollapsed ? 'collapses-desktop-view' : 'expanded-desktop-view'"
      class="desktop-toolbar"
      mode="side"
      [opened]="true"
      [autoFocus]="false"
    >
      <mat-nav-list class="nav-list">
        <a
          mat-list-item
          routerLinkActive="active-link"
          [routerLink]="isValidAccessToken ? ['/all-expenses'] : null"
          [disabled]="!isValidAccessToken"
        >
          <ng-container [ngSwitch]="isSidenavCollapsed">
            <ng-container *ngSwitchCase="false">
              <mat-icon>payments</mat-icon>
              <span>All expenses</span>
            </ng-container>

            <ng-container *ngSwitchCase="true">
              <mat-icon matTooltip="All expenses" [matTooltipPosition]="'right'">payments</mat-icon>
            </ng-container>
          </ng-container>
        </a>

        <a
          mat-list-item
          routerLinkActive="active-link"
          [routerLink]="isValidAccessToken ? ['/expenses'] : null"
          [disabled]="!isValidAccessToken"
        >
          <ng-container [ngSwitch]="isSidenavCollapsed">
            <ng-container *ngSwitchCase="false">
              <mat-icon>paid</mat-icon>
              <span>Expenses (Simple)</span>
            </ng-container>

            <ng-container *ngSwitchCase="true">
              <mat-icon matTooltip="Expenses (Simple)" [matTooltipPosition]="'right'">paid</mat-icon>
            </ng-container>
          </ng-container>
        </a>

        <a mat-list-item (click)="toggleSidenav()">
          <ng-container [ngSwitch]="isSidenavCollapsed">
            <ng-container *ngSwitchCase="false">
              <mat-icon>keyboard_double_arrow_left</mat-icon>
              <span>Collapse</span>
            </ng-container>

            <ng-container *ngSwitchCase="true">
              <mat-icon matTooltip="Expand" [matTooltipPosition]="'right'">keyboard_double_arrow_right</mat-icon>
            </ng-container>
          </ng-container>
        </a>
      </mat-nav-list>
    </mat-sidenav>

    <mat-sidenav-content [ngClass]="isSidenavCollapsed ? 'collapsed-sidenav-content' : 'expanded-sidenav-content'">
      <div class="main-content">
        <router-outlet></router-outlet>
      </div>
    </mat-sidenav-content>
  </mat-sidenav-container>

  <mat-toolbar class="mobile-toolbar">
    <mat-nav-list class="mobile-nav-list">
      <a
        class="flex-grow-1"
        mat-list-item
        routerLinkActive="active-link"
        [routerLink]="tokenAuthService.isValidAccessToken() ? ['/all-expenses'] : null"
        [disabled]="!tokenAuthService.isValidAccessToken()"
      >
        <mat-icon>payments</mat-icon>
        <span>All expenses</span>
      </a>
      <a
        mat-list-item
        routerLinkActive="active-link"
        [routerLink]="tokenAuthService.isValidAccessToken() ? ['/expenses'] : null"
        [disabled]="!tokenAuthService.isValidAccessToken()"
      >
        <mat-icon>paid</mat-icon>
        <span>Expenses (Simple)</span>
      </a>
    </mat-nav-list>
  </mat-toolbar>
</ng-container>

<ng-container *ngIf="layoutVersion === LayoutVersion.Standard">
  <ng-container *ngIf="!configService.config.featureFlags.multiTabMode; else multiTabSolution">
    <app-header></app-header>
    <router-outlet></router-outlet>
  </ng-container>

  <ng-template #multiTabSolution>
    <ng-container [ngSwitch]="isAppAvailable">
      <ng-container *ngSwitchCase="true">
        <app-header></app-header>
        <router-outlet></router-outlet>
      </ng-container>

      <div *ngSwitchCase="false">
        <p data-test-id="warning">WARNING: Multi tab usage is not allowed.</p>
        <p>You can see that warning because you are trying to open App in another tab.</p>
        <p>If you are sure there is no any opened tab you will be reloaded in {{ timeLeft }}s...</p>
      </div>
    </ng-container>
  </ng-template>
</ng-container>
